@* Views/Admin/ShowGeneratedPassword.cshtml *@
@{
    ViewData["Title"] = "كلمة المرور المولدة";
    Layout = "_Layout";
}

<div class="content-container" style="max-width: 700px; margin-top: 3rem;">
    <div class="info-card" style="border-right-color: var(--success-green); text-align: center;">
        <h2 style="color: var(--success-green); margin-bottom: 2rem;">
            <i class="fas fa-check-circle"></i>
            تم إنشاء المستخدم بنجاح
        </h2>

        <div style="background: white; border: 2px solid var(--primary-blue); border-radius: 12px; padding: 2rem; margin-bottom: 2rem;">
            <div style="margin-bottom: 1.5rem;">
                <strong style="color: var(--primary-blue); font-size: 1.1rem;">المستخدم:</strong>
                <p style="font-size: 1.2rem; margin: 0.5rem 0;">@ViewBag.UserName</p>
            </div>

            <div style="margin-bottom: 1.5rem;">
                <strong style="color: var(--primary-blue); font-size: 1.1rem;">البريد الإلكتروني:</strong>
                <p style="font-size: 1.2rem; margin: 0.5rem 0; direction: ltr; text-align: center;">@ViewBag.UserEmail</p>
            </div>

            <div style="background: linear-gradient(135deg, var(--lightest-blue) 0%, white 100%); padding: 1.5rem; border-radius: 10px; margin-top: 2rem;">
                <strong style="color: var(--primary-blue); font-size: 1.2rem; display: block; margin-bottom: 1rem;">
                    <i class="fas fa-key"></i>
                    كلمة المرور المولدة:
                </strong>
                <div style="background: white; padding: 1rem; border-radius: 8px; border: 2px dashed var(--primary-blue); position: relative;">
                    <code id="passwordText" style="font-size: 1.8rem; font-weight: bold; color: var(--primary-blue); letter-spacing: 2px; font-family: 'Courier New', monospace;">
                        @ViewBag.GeneratedPassword
                    </code>
                    <button type="button" onclick="copyPassword()" class="btn btn-sm btn-info" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%);">
                        <i class="fas fa-copy"></i>
                        نسخ
                    </button>
                </div>
            </div>
        </div>

        <div style="background: #fef3c7; border: 2px solid #f59e0b; border-radius: 10px; padding: 1.5rem; margin-bottom: 2rem; text-align: right;">
            <h4 style="color: #92400e; margin-bottom: 1rem;">
                <i class="fas fa-exclamation-triangle"></i>
                تعليمات مهمة:
            </h4>
            <ol style="color: #78350f; text-align: right; padding-right: 1.5rem;">
                <li style="margin-bottom: 0.5rem;">انسخ كلمة المرور أعلاه</li>
                <li style="margin-bottom: 0.5rem;">أرسلها للمستخدم عبر البريد الإلكتروني أو بأي طريقة آمنة</li>
                <li style="margin-bottom: 0.5rem;">سيُطلب من المستخدم تغيير كلمة المرور عند تسجيل الدخول لأول مرة</li>
                <li style="margin-bottom: 0.5rem;">لن تتمكن من رؤية كلمة المرور مرة أخرى بعد مغادرة هذه الصفحة</li>
            </ol>
        </div>

        <div style="display: flex; gap: 1rem; justify-content: center;">
            <button type="button" onclick="copyPassword()" class="btn btn-primary" style="min-width: 200px;">
                <i class="fas fa-copy"></i>
                نسخ كلمة المرور
            </button>
            <a href="@Url.Action("Students", "Admin")" class="btn btn-success" style="min-width: 200px;">
                <i class="fas fa-check"></i>
                تم - العودة للوحة التحكم
            </a>
        </div>

        <div id="copyAlert" style="display: none; margin-top: 1rem; padding: 1rem; background: #d1fae5; color: #065f46; border-radius: 8px; font-weight: bold;">
            <i class="fas fa-check-circle"></i>
            تم نسخ كلمة المرور!
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function copyPassword() {
            const passwordText = document.getElementById('passwordText').textContent.trim();
            
            // Copy to clipboard
            navigator.clipboard.writeText(passwordText).then(function() {
                // Show success message
                const alert = document.getElementById('copyAlert');
                alert.style.display = 'block';
                
                // Hide after 3 seconds
                setTimeout(function() {
                    alert.style.display = 'none';
                }, 3000);
            }, function(err) {
                console.error('Could not copy text: ', err);
            });
        }

        // Warn user before leaving page
        window.addEventListener('beforeunload', function (e) {
            e.preventDefault();
            e.returnValue = 'هل أنت متأكد أنك نسخت كلمة المرور؟ لن تتمكن من رؤيتها مرة أخرى.';
        });

        // Remove warning when clicking "Done" button
        document.querySelector('a[href*="Students"]').addEventListener('click', function() {
            window.removeEventListener('beforeunload', null);
        });
    </script>
}